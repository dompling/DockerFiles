
FROM alpine

RUN apt-get update
RUN apk add --no-cache --virtual .build-deps \
    ca-certificates \
    curl \
    tzdata \
    git \
    nodejs \
    npm \
    nginx\
    && mkdir /git \
    && mkdir /Sub-Store

ENV SourcePath="https://github.com/dompling/Sub-Store.git"
ENV DMIAN="/"

WORKDIR /Sub-Store

COPY sub-store.sh /usr/local/bin/sub-store
RUN chmod +x /usr/local/bin/sub-store

RUN git clone ${SourcePath} /git \
    && cd /git/backend \
    && cnpm install \
    && cd /git/web \
    && cnpm install

ENTRYPOINT [ "sub-store" ]